<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>How to recover your Secret Recovery Phrase</title>
</head>
<body>
    <h1>How to recover your Secret Recovery Phrase</h1>
    <p><em>MetaMask provides you with a unique 12-word Secret Recovery Phrase on the very first launch. If you did not write it down, or you lost it, you can unlock MetaMask and <a href="https://support.metamask.io/hc/en-us/articles/360015290032" target="_self">reveal your Secret Recovery Phrase</a>.</em></p>

    <h3>Are you in a situation where you don't have access to your Secret Recovery Phrase?</h3>
    <p>This can happen, for example, if your computer broke and you didn't back up your SRP. Because the SRP is the tool that creates and controls all your accounts, it might be that you've lost access to them forever. Or maybe not.</p>
    <p>If you can <a href="https://www.lifewire.com/access-data-from-an-old-hard-drive-5201989">plug that old hard drive into your computer and access it</a>, or if you have a cloud backup of your system, or some other method of accessing the system data, you may be able to recover the SRP.</p>
    <p>If, for whatever reason, you cannot unlock MetaMask using your password, there may still be a <em>possibility</em> of recovering your Secret Recovery Phrase.</p>
    <p>Follow these instructions, and if you get stuck, start a conversation with our Support agents.</p>

    <h4>This article is to be used under the following circumstances:</h4>
    <ol>
        <li>You <strong>do not</strong> know your Secret Recovery Phrase</li>
        <li>You <strong>do</strong> know your password</li>
        <li>For some reason you are <strong>unable to unlock MetaMask</strong> with your password</li>
        <li>You are using MetaMask Extension in a desktop browser.</li>
    </ol>

    <div class="callout callout--info">
        <h4 class="callout__title">Note:</h4>
        <ul>
            <li>Vault recovery on Android and iOS mobile devices is <span class="wysiwyg-underline">not currently possible.</span></li>
            <li>If you have uninstalled the MetaMask extension, your data has likely been deleted. However, you may attempt the method below, under the heading "What if you no longer have access to the browser...?" especially if you have a backup of your computer's data.</li>
        </ul>
    </div>

    <p>If you're not sure if this situation applies to you, <a href="https://support.metamask.io/hc/en-us/articles/13112366068251">consult the various scenarios here</a> to help you determine which is right for you.</p>

    <div class="callout callout--primary">
        <h4 class="callout__title">A few things before we begin...</h4>
        <ul>
            <li>We know that potentially losing access to MetaMask and your assets is stressful — that's why we've put this content together, so that you might be able to resolve that stress. We wish we could do more, but <a href="https://support.metamask.io/hc/en-us/articles/360059952212" target="_self">MetaMask is self-custodial</a> by design. We're rooting for you though!</li>
            <li>We do our best to keep these instructions up to date, but since they depend in part on the back end of third-party platforms (the browsers), sometimes things may have changed relative to what we describe below. If so, please let us know by <a href="https://support.metamask.io/hc/en-us/articles/360058969391" target="_self">getting in touch with Support</a>.</li>
            <li>This is not a simple process, so make sure you set aside roughly 30 minutes and that you're in a location where you can focus. If you get stuck, get in touch.</li>
            <li>The final step of the process, once you've recovered your SRP, will be to <a href="https://support.metamask.io/hc/en-us/articles/360015289612">restore your wallet</a>. Keep in mind that <strong>MetaMask stores only one SRP per browser profile at a time</strong>, and <strong>importing an SRP into an existing MetaMask installation wipes any SRP data</strong> already present in that profile's vault.
                <ul>
                    <li>If you're only managing one SRP, then this isn't really an issue; <strong>if you're managing multiple SRPs</strong>, however, we strongly recommend you <a href="https://support.metamask.io/hc/en-us/articles/12174759849371" target="_self">follow our best practices outlined here</a>.</li>
                </ul>
            </li>
        </ul>
    </div>

    <div class="tabs">
        <div class="tabs-menu">
            <span class="tabs-link is-active">Extension</span> <span class="tabs-link">iOS</span> <span class="tabs-link">Android</span>
        </div>

        <div class="tab">
            <h2>Vault extraction and decryption instructions</h2>
            <p>If you’re here, you probably want to get straight to solving the issue. However, if you get stuck, it might help to understand what’s going on. We’ve provided an in-depth explanation of how this all works further down, in case you need it now, or want to read it another time.</p>
            
            <div class="accordion accordion--default">
                <div class="accordion__item">
                    <div class="accordion__item-title">Chrome-based browsers
                        <h4>(includes Chrome, Brave, Edge, and Opera)</h4>
                    </div>
                    <div class="accordion__item-content">
                        <h3>Step One: Load the Vault Decryptor Tool</h3>
                        <p>This tool was written by MetaMask co-founder Dan Finlay, and has recently been updated to be much more user-friendly. The decryptor can be accessed in a web page here:</p>
                        <p><a href="https://metamask.github.io/vault-decryptor/" class="wysiwyg-underline">https://metamask.github.io/vault-decryptor/</a></p>
                        <p><strong>If you’re concerned about someone having access to your computer over the Internet, you can load this page, and then disconnect your internet connection; it will work offline.<br></strong>You can even download the code and run it on your machine, if you want to. The repository is <a href="https://github.com/MetaMask/vault-decryptor" class="wysiwyg-underline">here.</a></p>
                        
                        <h3>Step Two: Locate your Vault</h3>
                        <p>When you load the tool, the easiest method by far of using it will be to click on "Database backup", then "Choose File":</p>
                        <p class="wysiwyg-text-align-center"><img src="https://metamask.zendesk.com/hc/article_attachments/13473929359643"></p>
                        <p>At this point, a file explorer window will open, and you'll need to find the vault.</p>
                        
                        <p><strong>In Windows 10 or 11</strong>, you should be able to find the location of the vault by going to this folder location (you need to be able to see the hidden files):</p>
                        <p><em>C:\\Users\\USER_NAME\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Local Extension Settings\\nkbihfbeogaeaoehlefnkodbefgpgknn</em></p>
                        
                        <p><strong>On a Mac,</strong> the location of the folder should be: <br><em>Library &gt; Application Support &gt; Google &gt; Chrome &gt; Default &gt; Local Extension Settings &gt; nkbihfbeogaeaoehlefnkodbefgpgknn</em></p>
                        
                        <p>This folder contains various user data of the MetaMask extension, including your vault. Your vault is contained in a <strong>.ldb</strong> file and will likely be called 000003.ldb or something similar--<strong>the specific number may differ, but it should be a low numerical value, like 000005 or 000004. If it is a larger number, it is not the vault:</strong></p>
                        <p class="wysiwyg-text-align-center"><img src="https://metamask.zendesk.com/hc/article_attachments/13474146474139"></p>

                        <div class="note note--info">
                            <h4 class="note-title">Handling multiple vault files</h4>
                            <p>If you have imported multiple SRPs into MetaMask on this system--and many of us have--you may have multiple vault files. You can decrypt each one, so long as you know its corresponding password.</p>
                            <p><strong>If you imported an SRP into MetaMask, and "lost" the SRP you had in MetaMask previously, that old SRP's vault file may still be on your system. You may be able to recover it using this process, so long as you know the password.</strong></p>
                            <p>If you have an idea of what your password was, but can't <em>quite</em> remember, you might want to try using <a href="https://btcrecover.readthedocs.io/en/latest/">btcrecover</a>, a tool designed to help people manage and recover cryptographic keys. Specifically, it has functionality that automates the process of trying lots of different variations of a password. For an idea of what this process involves, check out <a href="https://youtu.be/TzZDcN6SnCU?t=266">this chapter</a> of a btcrecover video tutorial.</p>
                        </div>

                        <h3>Step Three: Decrypt the vault</h3>
                        <p>This part is easy, so long as you know your password. Simply put in your password, hit "Decrypt", and your Secret Recovery Phrase should appear below the box:</p>
                        <p class="wysiwyg-text-align-center"><img src="https://metamask.zendesk.com/hc/article_attachments/13474291339803" alt="vault-ldbupload.png" width="531" height="481"></p>
                        <p><strong>Now: back up your SRP, <em>in the order in which the words appear on the screen</em>, somewhere safe.</strong></p>
                        <p>We recommend multiple copies in physical locations, or encrypted, non-Internet connected locations that you trust to be safe.</p>
                        <p>If you want to know more about a common form of key storage, hardware wallets, follow <a href="https://support.metamask.io/hc/en-us/articles/5450173968283-User-Guide-How-to-use-a-Hardware-Wallet">our guide here</a>.</p>
                        <p>Now that you have your SRP, you can proceed to <a href="https://support.metamask.io/hc/en-us/articles/360015289612-How-to-restore-your-MetaMask-wallet-from-Secret-Recovery-Phrase">import your SRP into MetaMask and restore access to your accounts.</a></p>
                    </div>
                </div>

                <div class="accordion__item">
                    <div class="accordion__item-title"><strong>Firefox</strong></div>
                    <div class="accordion__item-content">
                        <div class="note note--warning">
                            <h4 class="note-title">Current Limitations of these instructions</h4>
                            <p>Firefox has implemented changes to its data encoding that have made these instructions of limited use. If you have MetaMask installed in Firefox and know your password, the below instructions may help solve your problem. If, however, you no longer have access to the browser or are attempting to recover an SRP from an old file system or backup, these instructions may not help, unless you are able to somehow access an instance of Firefox on that file system. As soon as we have a better solution, these documents will be updated.</p>
                        </div>

                        <p>In Firefox you may need to have the MetaMask extension opened in 'Expanded view' to be able to open the 'Inspect Element' or Web Inspector. Check out this video and follow the instructions below:</p>
                        <p><iframe src="//player.vimeo.com/video/448249696" width="560" height="315" frameborder="0" allowfullscreen></iframe></p>
                        <p>Open a new tab in Firefox and enter the following in order to find the extension's <em>UUID</em> (Universally Unique Identifier):</p>
                        <p><strong>about:debugging#addons</strong></p>
                        <p class="wysiwyg-text-align-center"><img src="https://metamask.zendesk.com/hc/article_attachments/11188660768027" alt="UUID_Firefox.png" width="625" height="450"></p>

                        <p>You should be able to see the UUID of the MetaMask extension. Copy it to add it to the following URL (without the spaces):</p>
                        <p><strong>moz-extension://&lt;your-UUID-here&gt;/home.html</strong></p>
                        <p class="wysiwyg-text-align-center"><img src="https://metamask.zendesk.com/hc/article_attachments/11188660817435" alt="Extension_view_Firefox.png" width="625" height="381"></p>

                        <p>This will open the MetaMask wallet in a browser tab in Firefox.</p>
                        <ul>
                            <li>Right-click on the MetaMask wallet that's opened in the full-view tab to see the options</li>
                            <li>Click the 'Inspect Element' option</li>
                            <li>In the opened window, go to the Console tab</li>
                            <li>Enter this command in the Console and click enter or return (you can copy+paste the following command):</li>
                        </ul>
                        <pre>chrome.storage.local.get('data', result =&gt; {<br> var vault = result.data.KeyringController.vault<br> console.log(vault)<br>})</pre>
                        <ul>
                            <li>This should return a result that begins "<em>{\"data\":</em>". This is the vault data (which is in JSON format).</li>
                            <li>Copy it to your clipboard.</li>
                            <li>Proceed to the Vault Decryptor that you can find in the link below and also see the open-source code at <a href="https://github.com/MetaMask/vault-decryptor" target="_blank" rel="noopener noreferrer">GitHub</a>:</li>
                        </ul>
                        <p><a href="https://metamask.github.io/vault-decryptor/">https://metamask.github.io/vault-decryptor/</a></p>
                        <p><em>This Vault Decryptor tool can also be used offline, you just need to use your browser's tool bar &gt; File &gt; Save page as... &gt; MetaMask Decryptor.htm. Then open the <strong>MetaMask Decryptor.htm</strong> file in your browser with your computer disconnected from the Internet.</em></p>
                        <p><iframe src="//player.vimeo.com/video/448248687" width="560" height="315" frameborder="0" allowfullscreen></iframe></p>
                        <ul>
                            <li>On the Vault Decryptor page, paste the <em>{\"data\":}</em> part of the vault data and use the password you set for your wallet in the MetaMask Extension and click the "Decrypt" button.</li>
                            <li>If successful, you'll see the result below the Decrypt button showing the <em>"mnemonic"</em> 12 Word English Secret Recovery Phrase, along with any other imported <em>"Simple Key Pair"</em> (private key).</li>
                            <li>You can now use the Secret Recovery Phrase (and private keys) to restore your MetaMask wallet.</li>
                        </ul>
                    </div>
                </div>

                <div class="accordion__item">
                    <div class="accordion__item-title"><strong>Recovering an old SRP after importing another one (Chrome-based)</strong></div>
                    <div class="accordion__item-content">
                        <h3>Did you import an SRP into MetaMask and lose your old one?</h3>
                        <p>MetaMask can't detect multiple vault files, or switch between them--but if you imported an SRP to MetaMask, the vault might still be there, or in a backup of your system made at the time.</p>
                        <p>Currently, we only have a process for this on Chrome-based browsers, but we're working on it for Firefox, and we'll update this documentation when we have one. Follow the instructions above, under "Chrome-based browsers", and pay special attention to the note at the end of Step 2, regarding 'Multiple vault files'.</p>
                    </div>
                </div>

                <div class="accordion__item">
                    <div class="accordion__item-title"><strong>Manual extraction method</strong></div>
                    <div class="accordion__item-content">
                        <h3>What if I can't upload my vault file? (Chrome-based browsers <strong>only</strong>)</h3>
                        <p>The Vault Decryptor tool's vault upload feature has been built to avoid users having to step through a fair amount of manual work involved in finding, formatting, and extracting their vault data. However, if you're in a situation where, for whatever reason, you can't use that feature, the steps below may help.</p>
                        <p>Keep in mind that this process changes from time to time, without MetaMask being aware; this is due to the fact that Chrome can change the way it saves data to disk, for example; or <a href="https://blog.hubspot.com/website/what-is-utf-8">how it encodes data</a>, which affects this process. <strong>If you notice such a change, please let us know--keeping these instructions up to date is a group effort! ❤️🦊</strong></p>
                        <p><strong>In Windows 10 and 11</strong>, you should be able to find the location of the Vault by going to this folder location (you need to be able to see the hidden files):</p>
                        <p><em>C:\\Users\\USER_NAME\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Local Extension Settings\\nkbihfbeogaeaoehlefnkodbefgpgknn</em></p>

                        <p><strong>On a Mac,</strong> the location of the folder should be:<br><em>Library &gt; Application Support &gt; Google &gt; Chrome &gt; Default &gt; Local Extension Settings &gt; nkbihfbeogaeaoehlefnkodbefgpgknn</em></p>

                        <p>In that folder you'll see a file called 000003.ldb or something similar--<strong>the number doesn't matter, you're looking for .ldb files</strong>. Open that file with a text editor or code editor software like Atom (<a href="https://atom.io/">https://atom.io/</a>) or <a href="https://www.sublimetext.com/">Sublime Text</a>. <em>Note: The screenshot below says file type 'text document' because it was already opened with a text editor.</em></p>
                        <p><img src="https://metamask.zendesk.com/hc/article_attachments/360017332831" alt="screenshot_vault_location.PNG"></p>

                        <p>Once you've opened the file, search for the word "keyring". There will be a dense block of text following it (if using SublimeText, it might be easier to view it by clicking on "View" and "Enter Distraction-Free Mode"), which looks like this:</p>
                        <p><img src="https://metamask.zendesk.com/hc/article_attachments/10204253413659" alt="mceclip0.png"></p>

                        <p><strong>This is your vault data; however, we will need to re-format certain parts of it in order to be able to decrypt it: We'll need to make sure you have the "data", "iv", and "salt" sections properly labeled.</strong></p>
                        <p>In order to do this, we'll need to copy-paste your vault data to a new text editor file. Look at the section following "Keyring" in the text. There's a section that reads <strong>{\\"???'&lt;0x04&gt;\\"</strong>. That's the beginning of your vault data. Now look for the word "salt". Following "salt" there's a long string of alphanumeric characters in quotation marks, and that section ends with <strong>=\\"}</strong>. That's the end of your vault data, so <strong>copy from the opening curly bracket following "Keyring" to the closing curly bracket following the alphanumeric characters after "salt", and paste into a new text editor document.</strong></p>

                        <p>Whew! Now's the easy part. I promise.</p>
                        <p><strong>"data":</strong></p>
                        <p>You already saw this part of the text: <strong>{"???'&lt;0x04&gt;"</strong>. Keep in mind that yours might look a little different; it might be a different code between the triangle brackets, for example. In any case, make this part of the text look like: <strong>{"data"</strong>.</p>

                        <p><strong>"iv":</strong></p>
                        <p>This isn't always changed; in the screenshot above, for example, they're functional as-is. If your code looks like that, you're good to go!</p>

                        <p><strong>"salt":</strong></p>
                        <p>Like with "iv", look to make sure "salt" looks like it does in the screenshot above. Additionally, make sure that the entire text block ends like this: ="} <strong>not like this: </strong>=\\"}"}.</p>

                        <p><strong>remove slashes:</strong></p>
                        <p>Use the Search and Replace feature of the editor to change all the <strong>\\"</strong> to <strong>"</strong> (removing them):</p>
                        <p><img src="https://metamask.zendesk.com/hc/article_attachments/10206783991451" alt="mceclip2.png"></p>

                        <p>You would now have something like this:</p>
                        <p><em>{"data":"wwpXXtFCqZkYsWfeEwItZjJ0Cc7mRVjG47Dqh+ztL1PiCG6Izhg+zG0mM+H2ykyjz3X0RNhAE6IVsWFZamcZ47B4sVi4SvUxrMhARm5L3yHPxr3UsyGrOXmthyVMgEGmjwlmnFCNd2nMZ2o8/sRMra8FupurqevnBv57FiYpEEs7gPpFHv6587aL44MmKD8Snv4JLFqiqmlK82Waq5F+Iv9mw2sFVAL9mgZBSgFgbWdB3TsKVB2k","iv":"rkUQlNcGTxBE0My7a/bCXw==","salt":"HcKyNfGzaRALRQ0DlKgcIe5Uk30iI/M//oG6w8vX8Nk="}</em></p>

                        <h4><strong>OK! That's it! You're ready to decrypt!</strong></h4>

                        <p>You can now go to the Vault Decryptor (<a href="https://metamask.github.io/vault-decryptor/">https://metamask.github.io/vault-decryptor/</a>) and paste the vault data there, then enter the password you set for the extension when you created your MetaMask wallet. You should be able to see your secret Seed Phrase / Secret Recovery Phrase and any manually imported private key below if you click the Decrypt button.</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab is-hidden">
            <div class="callout callout--warning">
                <h4 class="callout__title">iOS method currently unavailable</h4>
                <p>We've recently become aware that the iOS recovery method is no longer working. We're investigating the cause and will update this page when we have updated instructions.</p>
                <p>However, and like Android, iOS devices now have an automated vault recovery method built-in. With v6.3.0 or later, if MetaMask detects any kind of problem with the vault files required to load MetaMask, the app will initiate an automatic recovery sequence.</p>
                <p>Note that this is <em>not</em> like the vault extraction method described above for Chrome-based browsers, and cannot be initiated manually.</p>
            </div>

            <h3><strong>In order to recover your vault data, you will need:</strong></h3>
            <ul>
                <li>You <strong>must have had</strong> iCloud backup enabled in your iCloud settings while the app was being used.</li>
                <li>The password that was used on MetaMask Mobile when the vault was created (or restored on that device)</li>
                <li>MacOS running on a separate computer or laptop, other than the mobile device in question</li>
                <li>An app capable of displaying JSON data in a readable fashion. You may need to download one, for example: <a href="https://imazing.com/download/macos">https://imazing.com/download/macos</a></li>
                <li>A WiFi connection or the appropriate cable to sync your phone and your computer</li>
            </ul>

            <h3><strong>Procedure</strong></h3>
            <ul>
                <li>Connect the mobile device to the computer, either via wifi or a physical cable, so that the mobile device appears in your Finder.</li>
                <li>Search for the word "KeyringController"</li>
                <li>Copy and paste that JSON object into a new document. It will look something like this:</li>
                <ul>
                    <li>{"cipher":"JaX8Z80QMzzqA4XMgPsUuleNLIuxvchXZ5q1SO9GO1kuNUmokUke06op9EF0ZU4WXsILfUZ0yKI5kjzYY9H12t5aGb43BOAWJwlKuC8neXWeL5enoD/L05eDC9tzZEBupLwF7cGG6JdPHHQKdRDWWbQM+TUo6EvZv7LClPZQVJ17uowGvPMPB0UwfPea7DP/dE5DYleHmX1rhxAJr1YN4HUPAYpCCReU4W4/2QsaM+E=","iv":"dcabe6ed590ae3ee8e056c7844c58047","salt":"h6IkHlWjloB9c9+KiGgYvQ==","lib":"original"}</li>
                </ul>
                <li>Back up the mobile device as per the instructions <a href="https://support.apple.com/guide/iphone/back-up-iphone-iph3ecf67d29/ios">here</a> under 'Backup your iPhone using your Mac'. We recommend using the <em>encrypted option</em>, and <strong>making a note of the password for later.</strong></li>
                <li>Select Manage Backups</li>
                <li>Show in Finder</li>
                <li>Drag the backup folder into the iMazing app, or whichever app you're using to read the backup. <strong>This is the point at which you'll need your password if you encrypted the backup.</strong></li>
                <li>In the backup tool, navigate to Apps -&gt; MetaMask -&gt; Documents -&gt; persistStore -&gt; persist-root</li>
                <li>Open the persist-root file. It will be a lengthy file in JSON format.</li>
                <li>Modify the object to reflect the example below (manually remove all \\ and ensure there are no white spaces):</li>
                <li>{"cipher":"JaX8Z80QMzzqA4XMgPsUuleNLIuxvchXZ5q1SO9GO1kuNUmokUke06op9EF0ZU4WssILfUZ0yKI5kjzYY9H12t5aGb43BOAWJwlKuC8neXWeL5enoD/L05eDC9tzZEBupLwF7cGG6JdPHHQKdRDWWbQM+TUo6EvZv7LClPZQVJ17uowGvPMPB0UwXPea7DP/dE5DYleHmX1rhxAJr1YN4HUPAYpCCReU4W4/2QsaM+E=","iv":"dcabe6ed590ae3ee8e056c7844c583d7","salt":"h6IkHlWjloBgc9+KiGTYvQ==","lib":"original"}</li>
                <li>Now you can copy the vault payload into the mobile app.</li>
                <li>Start up the MetaMask app on your iPhone and go to the Wallet Setup screen select “Import using Secret Recovery Phrase”</li>
            </ul>

            <p>In the Import using Secret Recovery Phrase screen, you can paste the vault into the seed phrase text box and then the password you want to try to unlock the vault in the password text boxes (passwords have to be the same). This is the password that was used when this vault was created or restored on this device. If the vault can be decrypted by the password, your wallet will be successfully set up.</p>

            <ul>
                <li>On successful setup of your wallet you should <strong>REMEMBER to back up your seed phrase after your wallet is set up.</strong></li>
            </ul>
        </div>

        <div class="tab is-hidden">
            <p>We are currently working on a solution for Android; as soon as it is available, we will post it here.</p>
            <p>However, and like iOS, MetaMask for Android now has an automated vault recovery method built-in. With v6.3.0 or later, if MetaMask detects any kind of problem with the vault files required to load MetaMask, the app will initiate an automatic recovery sequence.</p>
            <p>Note that this is <em>not</em> like the vault extraction method described above for Chrome-based browsers, and cannot be initiated manually.</p>
        </div>
    </div>

    <h3><strong>We urge you strongly to make sure that you always backup your Secret Recovery Phrase, and any manually imported private keys, so this never happens again.</strong></h3>
</body>
</html>
